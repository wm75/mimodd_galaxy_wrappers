<tool id="mimodd_covstats" name="MiModD Coverage Statistics" 
version="@MIMODD_WRAPPER_VERSION@">
    <description>
    calculates coverage statistics for a BCF file as generated by the MiModd Variant Calling tool
    </description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <expand macro="stdio" />
    <expand macro="version_command" />
    <command><![CDATA[
    mimodd covstats '$ifile' --ofile '$ofile'
    ]]></command>

    <inputs>
        <param name="ifile" type="data" format="bcf" label="BCF input file" 
        help="Use the Variant Calling tool to generate input for this tool."/>
    </inputs>
    <outputs>
        <data name="ofile" format="tabular" 
        label="Coverage Statistics for ${on_string}"/>
    </outputs>

    <tests>
        <test>
            <param name="ifile" value="a.bcf" />
            <output name="ofile" ftype="tabular">
                <assert_contents>
                    <has_n_columns n="3" />
                    <has_line_matching expression="^chrI&#009;.+" />
                    <has_line_matching expression="^chrII&#009;.+" />
                    <has_line_matching expression="^chrIII&#009;.+" />
                    <has_line_matching expression="^chrIV&#009;.+" />
                    <has_line_matching expression="^chrV&#009;.+" />
                    <has_line_matching expression="^chrX&#009;.+" />
                    <has_line_matching expression="^MtDNA&#009;.+" />
                </assert_contents>
            </output>
        </test>
    </tests>
    
    <help><![CDATA[
.. class:: infomark

   **What it does**

The tool takes as input a BCF file produced by the *Variant Calling* tool, and calculates per-chromosome read coverage from it.

.. class:: warningmark

   The tool treats genome positions missing from the BCF input as zero coverage, so it is safe to use ONLY with BCF files produced by the *Variant Calling* tool or through other commands that keep the information for all sites.

@HELP_FOOTER@
    ]]></help>
    <expand macro="citations" />
</tool>
